<h1>Benvenuto <%= user.name %></h1>
<br><br>
    <form action="/users/logout" method="POST">
        <button type="submit" class="btn btn-primary btn-block" style="width:200px;">Logout</button>
    </form>
    <br><br>
    <form action="/test/error" method="GET">
        <button type="submit" class="btn btn-primary btn-block" style="width:200px;">Get</button>
    </form>
    <br><br>
    <h3>Il tuo cookie scadr√† tra <%= scad %></h3>
    
    <% include ./partials/messages %>
    <br><br>
    <div id="chart"></div>
    <h3>Passeggeri</h3><p id="pas"></p>
    <h3>Latitudine</h3><p id="lat"></p>
    <h3>Longitudine</h3><p id="lon"></p>
    <h3>Movimento</h3><p id="mov"></p>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.9.2/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.0/c3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.dev.js"></script>
<script>
    var socket = io();
    socket.emit('event');
    socket.on('msg',function(data) {
        if(data.length > 0){
        writeOnChart(data)
        $('#pas').html(data[0].personeABordo);
        $('#lat').html(data[0].latitudine);
        $('#lon').html(data[0].longitudine);
        $('#mov').html(data[0].movimento);
        }
    })

    function writeOnChart(data){
        var array = [];
        for(let i = data.length -1 ;i > 1; i--){
            array.push(data[i].personeABordo);
        }
        array[0] = 'Passeggeri';
    var chart = c3.generate({
    bindto: '#chart',
    data: {
      columns: [
        array
      ]
    }
});
    }
    // $(document).on('click', 'a.scroll-to-top', function(e) {
    // var $anchor = $(this);
    // $('html, body').stop().animate({
    //   scrollTop: ($($anchor.attr('href')).offset().top)
    // }, 1000, 'easeInOutExpo');
    // e.preventDefault();
//   });
</script>






